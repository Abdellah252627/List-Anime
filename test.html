<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚</h1>
    <div id="results"></div>

    <script src="database.js"></script>
    <script>
        const results = document.getElementById('results');
        
        function addResult(message, isSuccess) {
            const div = document.createElement('div');
            div.className = `test-result ${isSuccess ? 'success' : 'error'}`;
            div.textContent = message;
            results.appendChild(div);
        }

        // Ø§Ø®ØªØ¨Ø§Ø± Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        try {
            const db = new AnimeDatabase();
            addResult('âœ… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', true);
            
            // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            const stats = db.getStats();
            if (stats && typeof stats.total !== 'undefined') {
                addResult('âœ… Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', true);
                addResult(`ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª: Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹=${stats.total}, Ù…Ø´Ø§Ù‡Ø¯Ø©=${stats.watching}, Ù…ÙƒØªÙ…Ù„Ø©=${stats.completed}, Ù…Ø³ØªÙ…Ø±Ø©=${stats.ongoing}, Ù…Ù†ØªÙ‡ÙŠØ©=${stats.finished}`, true);
            } else {
                addResult('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª', false);
            }
            
            // Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ù…ÙŠ
            const testAnime = {
                name: 'Ø§Ø®ØªØ¨Ø§Ø± Ø£Ù†Ù…ÙŠ',
                status: 'watching',
                totalEpisodes: 12,
                watchedEpisodes: 5,
                rating: 8,
                type: 'tv',
                season: 'spring-2024'
            };
            
            const addedAnime = db.addAnime(testAnime);
            if (addedAnime && addedAnime.id) {
                addResult('âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù†Ù…ÙŠ ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', true);
                
                // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«
                const updatedAnime = db.updateAnime(addedAnime.id, { watchedEpisodes: 7 });
                if (updatedAnime && updatedAnime.watchedEpisodes === 7) {
                    addResult('âœ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ù†Ù…ÙŠ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', true);
                } else {
                    addResult('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ù†Ù…ÙŠ', false);
                }
                
                // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­Ø°Ù
                const deleted = db.deleteAnime(addedAnime.id);
                if (deleted) {
                    addResult('âœ… Ø­Ø°Ù Ø§Ù„Ø£Ù†Ù…ÙŠ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­', true);
                } else {
                    addResult('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø£Ù†Ù…ÙŠ', false);
                }
            } else {
                addResult('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù†Ù…ÙŠ', false);
            }
            
        } catch (error) {
            addResult(`âŒ Ø®Ø·Ø£ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${error.message}`, false);
        }

        // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        const statusTests = [
            'watching', 'plan-to-watch', 'completed', 
            'ongoing', 'finished', 'not-aired'
        ];
        
        statusTests.forEach(status => {
            try {
                const db = new AnimeDatabase();
                const testAnime = {
                    name: `Ø§Ø®ØªØ¨Ø§Ø± ${status}`,
                    status: status,
                    totalEpisodes: 12,
                    watchedEpisodes: 0
                };
                const added = db.addAnime(testAnime);
                if (added) {
                    addResult(`âœ… Ø§Ù„Ø­Ø§Ù„Ø© "${status}" ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­`, true);
                    db.deleteAnime(added.id); // ØªÙ†Ø¸ÙŠÙ
                } else {
                    addResult(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø§Ù„Ø© "${status}"`, false);
                }
            } catch (error) {
                addResult(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­Ø§Ù„Ø© "${status}": ${error.message}`, false);
            }
        });

        addResult('ğŸ‰ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!', true);
    </script>
</body>
</html>